{% extends "base.html" %}

{% block content %}
<a href="/parties">View all Parties</a>
<section>
    <h2> {{ party.name }} </h2>
    <p>Next Game: {{ party.next_game }}</p>
    <br>
    <h3>Quick-ref information</h3>
    <p>Average Level: {{ average_level }}</p>
    <p>Total Weight: {{ total_weight }} kg</p>
    <p>Party access to Magical Damage: {{ magic_percent }}%</p>

    <p>Lowest Armour: {{ lowest_armour }} <br> {% for character in characters %}{% if lowest_armour == character.armour %}  <br> - {{ character.name }} {% endif %} {% endfor %}</p>

    <p>Highest Passive Perception: {{ highest_perception }} <br> {% for character in characters %}{% if highest_perception == character.perception %} <br> - {{ character.name }} {% endif %} {% endfor %}</p>

    <p>Highest Passive Insight: : {{ highest_insight }} <br> {% for character in characters %}{% if highest_insight == character.insight %} <br> - {{ character.name }} {% endif %} {% endfor %}</p>

    
    <form action="/parties/{{ party.id }}/edit">
        <input type="submit" value="Edit">
    </form>
</section>

<section>
    <h3>Characters in party: {{ num_of_players }} </h3>
    
    {% for character in characters %}
        <div>
            <p>{{ character.name }} the {{ character.race }} {{ character.archetype }}, level {{ character.level }} <br> played by {{ character.player.first_name }} </p>
            <form action="/characters/{{ character.id }}">
                <input type="submit" value="View Character">
            </form>
            <form action="/players/{{ character.player.id }}">
                <input type="submit" value="View Player">
            </form>
        </div>
    {% endfor %}
    {% if characters == [] %}
        <p>No characters/players yet!</p>
    {% endif %}
</section>
<section>
    <h4>Contact all players:</h4>
    <p> {{ all_contacts }}, </p>
</section>
<br>
<br>
<br>

<h4>Delete Party?</h4>
<p>Caution! This will remove all party details and associated Characters. Edit Characters to assign them to a new party first!</p>
<form action="/parties/{{ party.id }}/delete" method="POST">
    <label for="delete">Are you sure?</label>
    <input type="submit" id="delete" name="delete" value="Yes! Delete All.">
</form>


{% endblock %}